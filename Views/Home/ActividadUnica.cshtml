@using OldMates.Models
@{
    ViewData["Title"] = "Actividad Unica";

    List<Evento> Eventos = ViewBag.Eventos;
    List<Anotados> Anotados = ViewBag.Anotados;
    List<int> EventosInscripto = ViewBag.EventosInscripto ?? new List<int>();
    int IDusuario = ViewBag.IDUsuario;
    bool inscripto = EventosInscripto.Contains(Eventos?[0].ID ?? 0);

    int IDUsuario = ViewBag.IDUsuario;
    Evento evento = null;

    if (Eventos != null && Eventos.Count > 0)
        evento = Eventos[0];
}

@if (evento != null)
{
    <section class="task-list">
        <header class="task-list-header">
            <p>Título</p>
            <p>Descripción</p>
            <p>Fecha</p>
            <p>Finalizada</p>
            <p>Localidad</p>
            <p>Capacidad libre</p>
            <p>Intereses</p>
            <p>Foto</p>
            <p>Acciones</p>
        </header>

        <section>
            <p>@evento.Titulo</p>
            <p>@evento.Descripcion</p>
            <p>@evento.Fecha.ToString("dd/MM/yyyy")</p>
            <p>@(evento.Eliminada ? "Sí" : "No")</p>
            <p>@evento.Localidad</p>

            @{
                int anotadosEvento = 0;
                if (Anotados != null)
                    anotadosEvento = Anotados.Count(a => a.IDEvento == evento.ID);
            }
            <p>@(evento.Capacidad - anotadosEvento)</p>

            <p>@evento.Intereses</p>
            <p>
                <img src="@evento.Foto" style="max-width: 100px; max-height: 100px;" />
            </p>

            @if (evento.IDCreador == IDUsuario)
            {
                <p>
                    <a class="btn btn-secondary" href="@Url.Action("ModificarEvento", "Home", new { IDEvento = evento.ID })">Editar</a>
                    <a class="btn btn-danger" href="@Url.Action("BorrarEvento", "Home", new { IDEvento = evento.ID })">Eliminar</a>
                </p>
            }
            else
            {
                <p>
                    @if (inscripto)
                    {
                        <a class="btn btn-primary" href="@Url.Action("DesInscribirse", "Home", new { IDUsuario = IDUsuario, IDEvento = evento.ID })">DesInscribirse</a>
                    }
                    else
                    {
                        <a class="btn btn-primary" href="@Url.Action("DesInscribirse", "Home", new { IDUsuario = IDUsuario, IDEvento = evento.ID })">Inscribirse</a>
                    }
                </p>
            }
        </section>
    </section>
}
else
{
    <p class="empty-message">No tienes eventos registrados.</p>
}

