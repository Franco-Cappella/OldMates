@using OldMates.Models 
@{
    List<Evento> Eventos = ViewBag.Eventos;
    List<Anotados> Anotados = ViewBag.Anotados;
    int? IDUsuario = ViewBag.IDUsuario as int?;
}

<div class="container mt-4">
    <h2 class="title">Mis Actividades</h2>

    @if (Eventos != null && Eventos.Count > 0)
    {
        <div id="carouselActividades" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                @for (int i = 0; i < Eventos.Count; i++)
                {
                    var evento = Eventos[i];
                    int inscriptosEvento = Anotados.Count(a => a.IDEvento == evento.ID);
                    int capacidadLibre = evento.Capacidad - inscriptosEvento;

                    <div class="carousel-item @((i == 0) ? "active" : "")">
                        <div class="crsl-card-wz1">
                            <img src="@evento.Foto" class="crsl-img-wz1" alt="Foto del evento">

                            <div class="crsl-body-wz1">
                                <h5 class="crsl-title-wz1">@evento.Titulo</h5>
                                <p class="crsl-desc-wz1">@evento.Descripcion</p>

                                <p><strong>Fecha:</strong> @evento.Fecha.ToString("dd/MM/yyyy")</p>
                                <p><strong>Localidad:</strong> @evento.Localidad</p>
                                <p><strong>Capacidad libre:</strong> @capacidadLibre</p>
                                <p><strong>Intereses:</strong> @evento.Intereses</p>

                                <div class="mt-2">
                                    @if (evento.IDCreador == IDUsuario)
                                    {
                                        <a class="btn btn-secondary btn-sm me-2"
                                           href="@Url.Action("ModificarEvento", "Home", new { IDEvento = evento.ID })">Editar</a>

                                        <a class="btn btn-danger btn-sm"
                                           href="@Url.Action("BorrarEvento", "Home", new { IDEvento = evento.ID })">Eliminar</a>
                                    }
                                    else
                                    {
                                        <a class="btn btn-warning btn-sm"
                                           href="@Url.Action("DesInscribirse", "Home", new { IDEvento = evento.ID })">
                                            Desinscribirse
                                        </a>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <!-- Flechas de navegaciÃ³n -->
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselActividades" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </button>

            <button class="carousel-control-next" type="button" data-bs-target="#carouselActividades" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
            </button>
        </div>
    }
    else
    {
        <p class="empty-message">No tienes eventos registrados.</p>
    }
</div>
